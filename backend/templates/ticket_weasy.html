<!doctype html>
<html lang="{{ i18n.lang|default('ru') }}">
<head>
  <meta charset="utf-8" />
  <title>{{ page_title }}</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 24px;
      font-family: DejaVu Sans, Arial, sans-serif;
      font-size: 14px;
      color: #0b1220;
      background: #ffffff;
    }
    h1, h2, h3, p { margin: 0; }
    .page {
      width: 100%;
    }
    table.layout {
      width: 100%;
      table-layout: fixed;
      border-collapse: separate;
      border-spacing: 10px;
    }
    td { vertical-align: top; }
    .card {
      border: 1px solid #e6ecf5;
      border-radius: 8px;
      padding: 10px;
      background: #ffffff;
    }
    .muted { color: #5f708a; }
    .title { font-size: 18px; font-weight: 700; }
    .subtitle { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; }
    .route-title { font-size: 20px; font-weight: 700; }
    .break { overflow-wrap: anywhere; word-break: break-word; }
    .status-chip {
      display: inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 700;
      background: #f3f4f6;
      color: #111827;
    }
    .status-chip.ok { background: #e8f7ee; color: #166534; }
    .kv-table {
      width: 100%;
      table-layout: fixed;
      border-collapse: separate;
      border-spacing: 6px;
    }
    .kv-label { width: 42%; color: #5f708a; font-size: 12px; }
    .kv-value { width: 58%; font-weight: 600; }
    .section-title { font-size: 14px; font-weight: 700; margin-bottom: 6px; }
    .block + .block { margin-top: 10px; }
    .qr-box {
      width: 116px;
      height: 116px;
      border: 1px solid #e6ecf5;
      border-radius: 6px;
      background: #ffffff;
    }
    .qr-box img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }
    .link-button {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 6px;
      background: #1e4d7a;
      color: #ffffff;
      text-decoration: none;
      font-size: 11px;
      font-weight: 700;
    }
    .footer {
      font-size: 12px;
      color: #5f708a;
      text-align: center;
      margin-top: 8px;
    }
    .inline-note { font-size: 12px; color: #5f708a; }
  </style>
</head>
<body>
  <div class="page">
    <table class="layout">
      <tr>
        <td style="width: 60%;">
          <div class="card">
            <div class="subtitle">{{ i18n.brand_name }}</div>
            <div class="title">{{ i18n.ticket_label }}</div>
            <div class="route-title break">{{ route.label or i18n.value_not_available }}</div>
            <div class="muted">{{ i18n.trip_date_label }}: {{ ticket.trip_date or i18n.value_not_available }}</div>
          </div>
        </td>
        <td style="width: 40%;">
          <div class="card">
            <div class="section-title">{{ i18n.payment_section }}</div>
            <div class="status-chip {{ status_chip.css_class }}">{{ status_chip.text }}</div>
            <table class="kv-table">
              <tr>
                <td class="kv-label">{{ i18n.ticket_number_label }}</td>
                <td class="kv-value break">{{ ticket.number or i18n.value_not_available }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.order_label }}</td>
                <td class="kv-value break">{{ ticket.order_number or i18n.value_not_available }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.seat_label }}</td>
                <td class="kv-value">{{ ticket.seat_number or i18n.value_not_available }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.baggage_label }}</td>
                <td class="kv-value">{{ ticket.baggage_text or i18n.value_not_available }}</td>
              </tr>
            </table>
          </div>
        </td>
      </tr>
    </table>

    <table class="layout">
      <tr>
        <td style="width: 60%;">
          <div class="card">
            <div class="section-title">{{ i18n.trip_section }}</div>
            <div class="block">
              <div class="title">{{ departure.title }}</div>
              <table class="kv-table">
                <tr>
                  <td class="kv-label">{{ i18n.datetime_label }}</td>
                  <td class="kv-value">{{ departure.date or i18n.value_not_available }} {{ departure.time or '' }}</td>
                </tr>
                <tr>
                  <td class="kv-label">{{ i18n.address_label }}</td>
                  <td class="kv-value break">{{ departure.address or i18n.value_not_available }}</td>
                </tr>
                {% if departure.map_url %}
                <tr>
                  <td class="kv-label">{{ i18n.open_map }}</td>
                  <td class="kv-value break"><a href="{{ departure.map_url }}">{{ departure.map_url }}</a></td>
                </tr>
                {% endif %}
              </table>
            </div>
            <div class="block">
              <div class="title">{{ arrival.title }}</div>
              <table class="kv-table">
                <tr>
                  <td class="kv-label">{{ i18n.datetime_label }}</td>
                  <td class="kv-value">{{ arrival.date or i18n.value_not_available }} {{ arrival.time or '' }}</td>
                </tr>
                <tr>
                  <td class="kv-label">{{ i18n.address_label }}</td>
                  <td class="kv-value break">{{ arrival.address or i18n.value_not_available }}</td>
                </tr>
                {% if arrival.map_url %}
                <tr>
                  <td class="kv-label">{{ i18n.open_map }}</td>
                  <td class="kv-value break"><a href="{{ arrival.map_url }}">{{ arrival.map_url }}</a></td>
                </tr>
                {% endif %}
              </table>
            </div>
            {% if timeline.duration_text %}
            <div class="block">
              <div class="section-title">{{ i18n.duration_label }}</div>
              <div>{{ timeline.duration_text }}</div>
            </div>
            {% endif %}
          </div>
        </td>
        <td style="width: 40%;">
          <div class="card block">
            <div class="section-title">{{ i18n.passenger_section }}</div>
            <table class="kv-table">
              <tr>
                <td class="kv-label">{{ i18n.full_name_label }}</td>
                <td class="kv-value">{{ passenger.name or i18n.value_not_available }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.phone_label }}</td>
                <td class="kv-value">{{ passenger.phone or i18n.value_not_available }}</td>
              </tr>
              <tr>
                <td class="kv-label">Email</td>
                <td class="kv-value break">{{ passenger.email or i18n.value_not_available }}</td>
              </tr>
            </table>
          </div>
          <div class="card block">
            <div class="section-title">{{ i18n.payment_section }}</div>
            <table class="kv-table">
              <tr>
                <td class="kv-label">{{ i18n.status_label }}</td>
                <td class="kv-value">{{ payment.status_text }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.method_label }}</td>
                <td class="kv-value">{{ payment.method_text }}</td>
              </tr>
              <tr>
                <td class="kv-label">{{ i18n.amount_label }}</td>
                <td class="kv-value">{{ payment.amount_text }}</td>
              </tr>
            </table>
          </div>
          <div class="card">
            <div class="section-title">QR</div>
            <table class="kv-table">
              <tr>
                <td style="width: 45%;">
                  <div class="qr-box">
                    {% if qr_data_uri %}
                      <img src="{{ qr_data_uri }}" alt="QR" />
                    {% else %}
                      <div class="inline-note">{{ i18n.qr_unavailable }}</div>
                    {% endif %}
                  </div>
                </td>
                <td style="width: 55%;">
                  <div class="inline-note">{{ i18n.manage_online_hint }}</div>
                  <div class="break" style="margin-top: 6px;">{{ deep_link or i18n.value_not_available }}</div>
                  {% if deep_link %}
                    <div style="margin-top: 8px;">
                      <a class="link-button" href="{{ deep_link }}">{{ i18n.manage_online_button }}</a>
                    </div>
                  {% endif %}
                </td>
              </tr>
            </table>
          </div>
        </td>
      </tr>
    </table>

    <div class="footer">
      Maximov Tours ¬∑ {{ i18n.company_phone }} ¬∑ {{ i18n.company_phone_alt }} ¬∑ {{ i18n.company_email }} ¬∑ <a href="{{ i18n.company_instagram }}">üì∑ Instagram</a>
      <span class="inline-note"> ¬∑ –í—Ä–µ–º—è –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è</span>
    </div>
  </div>
</body>
</html>
